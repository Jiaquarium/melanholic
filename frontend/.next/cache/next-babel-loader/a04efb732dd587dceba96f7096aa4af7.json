{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport fs from 'fs';\nimport path from 'path';\nimport matter from 'gray-matter';\nconst postsDirectory = path.join(process.cwd(), 'posts-data');\n\nfunction getAllFileData(fileNames) {\n  return fileNames.map(fileName => {\n    return new Promise((resolve, reject) => {\n      // remove md from fileName to get Id\n      const Id = fileName.replace(/\\.md$/, ''); // read markdown as string\n\n      const fullPath = path.join(postsDirectory, fileName);\n      return fs.readFile(fullPath, {\n        encoding: 'utf8'\n      }, (err, fileContents) => {\n        // use gray-matter to parse through YAML \"front-matter\"\n        console.log(\"fileContents\" + fileContents);\n        const matterResult = matter(fileContents); // combine the data with Id\n\n        if (err) {\n          return reject(err);\n        } else {\n          return resolve(_objectSpread({\n            Id\n          }, matterResult.data));\n        }\n\n        ;\n      });\n    });\n  });\n}\n\nexport async function getSortedPostsData() {\n  // get file names under post\n  return new Promise(resolve => fs.readdir(postsDirectory, (err, fileNames) => {\n    Promise.all(getAllFileData(fileNames)).then(allPostData => resolve({\n      props: allPostData.sort((a, b) => a.date < b.date ? 1 : -1)\n    })).catch(err => {\n      console.log(\"something went wrong\");\n    });\n  }));\n}\n;","map":{"version":3,"sources":["/Users/jamesgu/github/personal/melanholic/nextjs-blog/lib/posts-data.js"],"names":["fs","path","matter","postsDirectory","join","process","cwd","getAllFileData","fileNames","map","fileName","Promise","resolve","reject","Id","replace","fullPath","readFile","encoding","err","fileContents","console","log","matterResult","data","getSortedPostsData","readdir","all","then","allPostData","props","sort","a","b","date","catch"],"mappings":";;;;;;AAAA,OAAOA,EAAP,MAAe,IAAf;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,MAAMC,cAAc,GAAGF,IAAI,CAACG,IAAL,CAAUC,OAAO,CAACC,GAAR,EAAV,EAAyB,YAAzB,CAAvB;;AAEA,SAASC,cAAT,CAAwBC,SAAxB,EACA;AACI,SAAOA,SAAS,CAACC,GAAV,CAAcC,QAAQ,IAAI;AAC7B,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KACnB;AACI;AACA,YAAMC,EAAE,GAAGJ,QAAQ,CAACK,OAAT,CAAiB,OAAjB,EAA0B,EAA1B,CAAX,CAFJ,CAII;;AACA,YAAMC,QAAQ,GAAGf,IAAI,CAACG,IAAL,CAAUD,cAAV,EAA0BO,QAA1B,CAAjB;AACA,aAAOV,EAAE,CAACiB,QAAH,CAAYD,QAAZ,EAAsB;AAACE,QAAAA,QAAQ,EAAE;AAAX,OAAtB,EAA0C,CAACC,GAAD,EAAMC,YAAN,KAAuB;AACpE;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAY,iBAAiBF,YAA7B;AACA,cAAMG,YAAY,GAAGrB,MAAM,CAACkB,YAAD,CAA3B,CAHoE,CAKpE;;AACA,YAAID,GAAJ,EACA;AACI,iBAAON,MAAM,CAACM,GAAD,CAAb;AACH,SAHD,MAKA;AACI,iBAAOP,OAAO;AACVE,YAAAA;AADU,aAEPS,YAAY,CAACC,IAFN,EAAd;AAIH;;AAAA;AACJ,OAjBM,CAAP;AAkBH,KAzBM,CAAP;AA0BH,GA3BM,CAAP;AA4BH;;AAED,OAAO,eAAeC,kBAAf,GAAoC;AACvC;AACA,SAAO,IAAId,OAAJ,CAAYC,OAAO,IAAIZ,EAAE,CAAC0B,OAAH,CAAWvB,cAAX,EAA2B,CAACgB,GAAD,EAAMX,SAAN,KAAoB;AACzEG,IAAAA,OAAO,CAACgB,GAAR,CACIpB,cAAc,CAACC,SAAD,CADlB,EAEEoB,IAFF,CAEOC,WAAW,IAAIjB,OAAO,CAAC;AAACkB,MAAAA,KAAK,EAAED,WAAW,CAACE,IAAZ,CAAiB,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,CAACE,IAAF,GAASD,CAAC,CAACC,IAAX,GAAkB,CAAlB,GAAsB,CAAC,CAAlD;AAAR,KAAD,CAF7B,EAGEC,KAHF,CAGQhB,GAAG,IAAI;AACXE,MAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACH,KALD;AAMH,GAP6B,CAAvB,CAAP;AAQH;AAAA","sourcesContent":["import fs from 'fs'\nimport path from 'path'\nimport matter from 'gray-matter'\n\nconst postsDirectory = path.join(process.cwd(), 'posts-data');\n\nfunction getAllFileData(fileNames)\n{\n    return fileNames.map(fileName => {\n        return new Promise((resolve, reject) =>\n        {\n            // remove md from fileName to get Id\n            const Id = fileName.replace(/\\.md$/, '');\n            \n            // read markdown as string\n            const fullPath = path.join(postsDirectory, fileName);\n            return fs.readFile(fullPath, {encoding: 'utf8'}, (err, fileContents) => {\n                // use gray-matter to parse through YAML \"front-matter\"\n                console.log(\"fileContents\" + fileContents);\n                const matterResult = matter(fileContents);\n        \n                // combine the data with Id\n                if (err)\n                {\n                    return reject(err);\n                }\n                else\n                {\n                    return resolve({\n                        Id,\n                        ...matterResult.data\n                    });\n                };\n            });\n        })\n    });\n}\n\nexport async function getSortedPostsData() {\n    // get file names under post\n    return new Promise(resolve => fs.readdir(postsDirectory, (err, fileNames) => {\n        Promise.all(\n            getAllFileData(fileNames)\n        ).then(allPostData => resolve({props: allPostData.sort((a, b) => a.date < b.date ? 1 : -1)})\n        ).catch(err => {\n            console.log(\"something went wrong\");\n        })\n    }));\n};"]},"metadata":{},"sourceType":"module"}